	<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN'
	  'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>

<mapper namespace='com.ericsson.raso.sef.core.db.mapper.ActorMapper'>

	<resultMap id="ActorResult" type="Actor">
		<id property="actorName" column="actor_Name" />
	</resultMap>

	<resultMap id="IdentitiesResult" type="Actor">
		<collection property="identities" javaType="HashMap"
			column="identities" />
		<collection property="memberships" javaType="HashMap"
			column="memberships" />
	</resultMap>

	<resultMap id='UserResult' type='User'>
		<id property='userId' column='user_Id' />
		<result property="password" column="password" />
		<result property="userMeta" column="meta" />
		<result property="userCredentialType" column="user_Credential_Type"
			ofType="Credential" />
	</resultMap>
	
	<resultMap id='CredentialResult' type='Type'>
		<id property="userCredentialType" column="user_Credential_Type" />
	</resultMap>
	
	<resultMap id='MetaResult' type='Meta'>
		<id property="key" column="meta-key" />
		<result property="value" column="meta-value" />
	</resultMap>
	
	<resultMap id='GroupResult' type='Group'>
		<id property="groupId" column="group_Id" />
		<result property="groupName" column="group_Name" />
		<result property="description" column="description" />
	</resultMap>

	<select id="fetchIdentity" resultMap="UserResult" parameterType="String">
		select Identity from User
		where user_Id
		= #{userId}
	</select>

	<select id="getGroupName" resultMap="ActorResult" parameterType="String">
		select groupName from Actor where actorId = #{actorId}
	</select>

	<insert id="createActor" parameterType="Actor">
		insert into
		actor(actorName,identities, memberships)values
		(#{actor_Name},
		#{identities}, #{memberships})
	</insert>

	<insert id="createMapping" parameterType="map" resultType='Type'>
		insert into groupmap(groupid,userid)values (#{groupid},#{userid})
	</insert>

	<update id='updateMetas' parameterType='Actor' resultType="Type" >
		update
		actor set credential = #{credential jdbcType=VARCHAR}
		where
		userId =
		#{userId}
	</update>

	<insert id="addMembership" parameterType="Group">
		insert into
		group(description, identities, memberships)values
		(#{actor_Name},
		#{identities}, #{memberships})
	</insert>

	<delete id='removeMembership' parameterType='int'>
		delete from group
		where
		userId=#{userId}
	</delete>

	<select id="isMemberOf" resultMap="ActorResult" parameterType="String">
		select groupName from Actor where actorId = #{actorId}
	</select>

	

</mapper>